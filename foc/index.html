<!DOCTYPE html>
<html lang="gl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cálculo do F.O.C.</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        body {
            background-color: #f8f9fa;
            padding: 20px;
        }
        .result {
            margin-top: 15px;
            font-weight: bold;
            font-size: 1.2rem;
        }
        .footer {
            margin-top: 50px;
            text-align: center;
            padding: 20px 0;
            background-color: #343a40;
            color: white;
        }
        .description {
            margin: 20px 0;
            font-size: 1rem;
        }

        /* Estilo para el selector de idioma */
        .language-selector {
            text-align: center;
            margin: 20px;
            background-color: #f0f0f0; /* Fondo gris claro */
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Sombra ligera */
        }

        .language-selector img {
            width: 40px;
            height: 30px;
            margin: 0 10px;
            cursor: pointer;
            transition: transform 0.2s ease; /* Transición suave */
        }

        /* Efecto hover sobre las banderas */
        .language-selector img:hover {
            transform: scale(1.1); /* Agranda ligeramente la bandera al pasar el ratón */
        }

        .language-selector img.selected {
            border: 2px solid #007bff;
        }

    </style>
</head>
<body>
    <!-- Selector de idioma con banderas -->
    <div class="language-selector">
        <p><strong>Selecciona idioma:</strong></p>
        <img src="../flagGalicia.png" id="gl" alt="Galego" title="Galego">
        <img src="../flagCatalonia.png" id="ca" alt="Català" title="Català">
        <img src="../flagSpain.png" id="es" alt="Español" title="Español">
    </div>

    <div class="container">
        <h1 class="text-center" id="page-title">Cálculo do F.O.C.</h1>

        <div class="description">
            <p id="description-text">O F.O.C. (Front of Center) é unha medida que indica a posición do centro de gravidade dunha flecha en relación á súa lonxitude total. Calcular o F.O.C. é importante para optimizar o rendemento da flecha na práctica de tiro con arco.</p>
        </div>

        <div class="form-group">
            <label for="distancia" id="distancia-label">Distancia desde o punto de equilibrio (S) en mm:</label>
            <input type="number" id="distancia" class="form-control" placeholder="Introduce S (mm)" min="0">
        </div>
        
        <div class="form-group">
            <label for="longitud" id="longitud-label">Lonxitude total da flecha (L) en mm:</label>
            <input type="number" id="longitud" class="form-control" placeholder="Introduce L (mm)" min="0">
        </div>

        <button id="calcular" class="btn btn-primary" id="calculate-button">Calcular F.O.C.</button>
        <button id="engadir" class="btn btn-success">Engadir</button>
        <button id="limpiar" class="btn btn-secondary">Limpar</button>

        <p id="resultado" class="result"></p>

        <!-- Tabela para mostrar o historial de intentos -->
        <h2 class="mt-5" id="history-title">Historial de Intentos</h2>
        <table class="table table-bordered mt-3">
            <thead>
                <tr>
                    <th id="attempt-number">Nº de Intento</th>
                    <th id="distance">Distancia S (mm)</th>
                    <th id="length">Lonxitude L (mm)</th>
                    <th id="foc">F.O.C. (%)</th>
                    <th id="actions">Accións</th>
                </tr>
            </thead>
            <tbody id="historial">
                <!-- As filas da táboa serán engadidas aquí -->
            </tbody>
        </table>

        <!-- Botón para volver á páxina de ferramentas -->
        <a href="../index.html" class="btn btn-secondary mt-3" id="volver-link">Voltar á Páxina de Ferramentas</a>
    </div>

    <div class="footer">
        <p>&copy; 2024 Pablo Belay</p>
    </div>

    <script>
        let intentos = 0; // Contador de intentos

        // Función para calcular o F.O.C.
        document.getElementById('calcular').onclick = function() {
            const S = parseFloat(document.getElementById('distancia').value); // Obter a distancia S
            const L = parseFloat(document.getElementById('longitud').value); // Obter a lonxitude L

            if (!isNaN(S) && !isNaN(L) && L > 0) {
                const foc = ((L / 2 - S) / L) * 100; // Fórmula para calcular o F.O.C.
                document.getElementById('resultado').innerText = `F.O.C. = ${foc.toFixed(2)} %`; // Mostrar o resultado
                return foc; // Devolver o valor do F.O.C. para usalo na función engadir
            } else {
                document.getElementById('resultado').innerText = "Por favor, introduce valores válidos."; // Mensaxe de erro
            }
        };

        // Función para engadir os datos á táboa
        document.getElementById('engadir').onclick = function() {
            const S = parseFloat(document.getElementById('distancia').value); // Obter a distancia S
            const L = parseFloat(document.getElementById('longitud').value); // Obter a lonxitude L
            const foc = ((L / 2 - S) / L) * 100; // Calcular o F.O.C.

            if (!isNaN(S) && !isNaN(L) && L > 0) {
                intentos++; // Incrementar o contador de intentos
                const historial = document.getElementById('historial');
                const novaFila = historial.insertRow(); // Engadir unha nova fila á táboa
                novaFila.insertCell(0).innerText = intentos; // Nº de intento
                novaFila.insertCell(1).innerText = S; // Distancia S
                novaFila.insertCell(2).innerText = L; // Lonxitude L
                novaFila.insertCell(3).innerText = foc.toFixed(2); // F.O.C.

                // Engadir botóns para editar e eliminar
                const cellAcciones = novaFila.insertCell(4);
                const botonEliminar = document.createElement('button');
                botonEliminar.innerText = 'Eliminar';
                botonEliminar.className = 'btn btn-danger btn-sm';
                botonEliminar.onclick = function() {
                    historial.deleteRow(novaFila.rowIndex - 1); // Eliminar a fila
                };
                const botonEditar = document.createElement('button');
                botonEditar.innerText = 'Editar';
                botonEditar.className = 'btn btn-warning btn-sm';
                botonEditar.onclick = function() {
                    document.getElementById('distancia').value = S; // Restablecer a distancia S
                    document.getElementById('longitud').value = L; // Restablecer a lonxitude L
                    historial.deleteRow(novaFila.rowIndex - 1); // Eliminar a fila actual
                };

                cellAcciones.appendChild(botonEliminar); // Engadir botón de eliminar
                cellAcciones.appendChild(botonEditar); // Engadir botón de editar
            } else {
                alert("Por favor, introduce valores válidos antes de engadir á táboa."); // Mensaxe de erro
            }
        };

        // Función para limpar os campos e o resultado
        document.getElementById('limpiar').onclick = function() {
            document.getElementById('distancia').value = ''; // Limpar a entrada S
            document.getElementById('longitud').value = ''; // Limpar a entrada L
            document.getElementById('resultado').innerText = ''; // Limpar o resultado
        };


         // Diccionario de traducciones
           // Diccionario de traducciones
        const translations = {
            gl: {
                "page-title": "Cálculo do F.O.C.",
                "description-text": "O F.O.C. (Front of Center) é unha medida que indica a posición do centro de gravidade dunha flecha en relación á súa lonxitude total. Calcular o F.O.C. é importante para optimizar o rendemento da flecha na práctica de tiro con arco.",
                "distancia-label": "Distancia desde o punto de equilibrio (S) en mm:",
                "longitud-label": "Lonxitude total da flecha (L) en mm:",
                "calculate-button": "Calcular F.O.C.",
                "history-title": "Historial de Intentos",
                "attempt-number": "Nº de Intento",
                "distance": "Distancia S (mm)",
                "length": "Lonxitude L (mm)",
                "foc": "F.O.C. (%)",
                "actions": "Accións",
                "volver-link": "Voltar á Páxina de Ferramentas"
            },
            es: {
                "page-title": "Cálculo del F.O.C.",
                "description-text": "El F.O.C. (Front of Center) es una medida que indica la posición del centro de gravedad de una flecha en relación con su longitud total. Calcular el F.O.C. es importante para optimizar el rendimiento de la flecha en la práctica de tiro con arco.",
                "distancia-label": "Distancia desde el punto de equilibrio (S) en mm:",
                "longitud-label": "Longitud total de la flecha (L) en mm:",
                "calculate-button": "Calcular F.O.C.",
                "history-title": "Historial de Intentos",
                "attempt-number": "Nº de Intento",
                "distance": "Distancia S (mm)",
                "length": "Longitud L (mm)",
                "foc": "F.O.C. (%)",
                "actions": "Acciones",
                "volver-link": "Volver a la Página de Herramientas"
            },
            ca: {
                "page-title": "Càlcul del F.O.C.",
                "description-text": "El F.O.C. (Front of Center) és una mesura que indica la posició del centre de gravetat d'una fletxa en relació amb la seva longitud total. Calcular el F.O.C. és important per optimitzar el rendiment de la fletxa a la pràctica de tir amb arc.",
                "distancia-label": "Distància des del punt d'equilibri (S) en mm:",
                "longitud-label": "Longitud total de la fletxa (L) en mm:",
                "calculate-button": "Calcular F.O.C.",
                "history-title": "Historial d'Intentos",
                "attempt-number": "Nº d'Intent",
                "distance": "Distància S (mm)",
                "length": "Longitud L (mm)",
                "foc": "F.O.C. (%)",
                "actions": "Accions",
                "volver-link": "Tornar a la Pàgina d'Eines"
            }
        };

        // Función para cambiar el idioma
        function changeLanguage(lang) {
            const translation = translations[lang];
            document.getElementById('page-title').innerText = translation["page-title"];
            document.getElementById('description-text').innerText = translation["description-text"];
            document.getElementById('distancia-label').innerText = translation["distancia-label"];
            document.getElementById('longitud-label').innerText = translation["longitud-label"];
            document.getElementById('calculate-button').innerText = translation["calculate-button"];
            document.getElementById('history-title').innerText = translation["history-title"];
            document.getElementById('attempt-number').innerText = translation["attempt-number"];
            document.getElementById('distance').innerText = translation["distance"];
            document.getElementById('length').innerText = translation["length"];
            document.getElementById('foc').innerText = translation["foc"];
            document.getElementById('actions').innerText = translation["actions"];
            document.getElementById('volver-link').innerText = translation["volver-link"];
            updateLinks(lang);
        }

        // Función para actualizar los enlaces con el parámetro lang
        function updateLinks(lang) {
            const volverLink = document.getElementById('volver-link');
            const url = new URL(volverLink.href);
            url.searchParams.set('lang', lang);  // Establece el parámetro lang en la URL
            volverLink.href = url.toString();  // Actualiza el enlace con el parámetro lang
        }

        // Función para obtener el idioma preferido del navegador
        function getBrowserLanguage() {
            const language = navigator.language || navigator.userLanguage;
            const lang = language.split('-')[0]; // Solo toma la parte del idioma (sin región)
            return lang;
        }

        // Obtener el idioma del navegador y cargar la página en ese idioma
        window.onload = function() {
            const lang = getBrowserLanguage();  // Obtiene el idioma del navegador
            const supportedLanguages = ['gl', 'es', 'ca'];  // Idiomas soportados
            const langToUse = supportedLanguages.includes(lang) ? lang : 'gl';  // Si no está en los idiomas soportados, usa 'gl'
            changeLanguage(langToUse);

            // Resaltar la bandera seleccionada
            document.getElementById('gl').classList.remove('selected');
            document.getElementById('ca').classList.remove('selected');
            document.getElementById('es').classList.remove('selected');
            document.getElementById(langToUse).classList.add('selected');
        };

        // Agregar evento de clic a cada bandera para cambiar el idioma
        document.getElementById('gl').addEventListener('click', function() { 
            changeLanguage('gl'); 
            updateLinks('gl');
        });
        document.getElementById('ca').addEventListener('click', function() { 
            changeLanguage('ca'); 
            updateLinks('ca');
        });
        document.getElementById('es').addEventListener('click', function() { 
            changeLanguage('es'); 
            updateLinks('es');
        });
    </script>
</body>
</html>
